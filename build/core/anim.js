Cold.add("anim",["dom"],function(){var e=Cold.dom.$E,n=Cold.dom.css,t=Cold.dom.create,s=Cold.dom.isStyle,h=Cold.dom.getXY,f=1.70158,r=function(){},k=Date.now||function(){return +new Date};var d={linear:function(v){return v},easeIn:function(v){return v*v},easeOut:function(v){return(2-v)*v},easeBoth:function(v){return(v*=2)<1?0.5*v*v:0.5*(1-(--v)*(v-2))},easeInStrong:function(v){return v*v*v*v},easeOutStrong:function(v){return 1-(--v)*v*v*v},easeBothStrong:function(v){return(v*=2)<1?0.5*v*v*v*v:0.5*(2-(v-=2)*v*v*v)},elasticIn:function(v){var x=0.3,w=x/4;if(v===0||v===1){return v}return -(Math.pow(2,10*(v-=1))*Math.sin((v-w)*(2*Math.PI)/x))},elasticOut:function(v){var x=0.3,w=x/4;if(v===0||v===1){return v}return Math.pow(2,-10*v)*Math.sin((v-w)*(2*Math.PI)/x)+1},elasticBoth:function(v){var x=0.45,w=x/4;if(v===0||(v*=2)===2){return v}if(v<1){return -0.5*(Math.pow(2,10*(v-=1))*Math.sin((v-w)*(2*Math.PI)/x))}return Math.pow(2,-10*(v-=1))*Math.sin((v-w)*(2*Math.PI)/x)*0.5+1},backIn:function(v){if(v===1){v-=0.001}return v*v*((f+1)*v-f)},backOut:function(v){return(v-=1)*v*((f+1)*v+f)+1},backBoth:function(v){if((v*=2)<1){return 0.5*(v*v*(((f*=(1.525))+1)*v-f))}return 0.5*((v-=2)*v*(((f*=(1.525))+1)*v+f)+2)},bounceIn:function(v){return 1-d.bounceOut(1-v)},bounceOut:function(v){var w=7.5625,x;if(v<(1/2.75)){x=w*v*v}else{if(v<(2/2.75)){x=w*(v-=(1.5/2.75))*v+0.75}else{if(v<(2.5/2.75)){x=w*(v-=(2.25/2.75))*v+0.9375}else{x=w*(v-=(2.625/2.75))*v+0.984375}}}return x},bounceBoth:function(v){if(v<0.5){return d.bounceIn(v*2)*0.5}return d.bounceOut(v*2-1)*0.5+0.5}};var g={re_RGB:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,re_hex:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,re_hex3:/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,getRGB:function(v){if(g.re_hex.exec(v)){v="rgb("+[parseInt(RegExp.$1,16),parseInt(RegExp.$2,16),parseInt(RegExp.$3,16)].join(", ")+")"}else{if(g.re_hex3.exec(v)){v="rgb("+[parseInt(RegExp.$1+RegExp.$1,16),parseInt(RegExp.$2+RegExp.$2,16),parseInt(RegExp.$3+RegExp.$3,16)].join(", ")+")"}}return v},isColorStyle:function(w){var v=/backgroundColor|borderBottomColor|borderLeftColor|borderRightColor|borderTopColor|color|outlineColor/i;return v.test(w)},init:function(x,z,C){var B,A,w,y,v=g.re_RGB;w=g.getRGB(n(x,z));w=w.match(v);B=[parseInt(w[1],10),parseInt(w[2],10),parseInt(w[3],10)];y=g.getRGB(C);y=y.match(v);A=[parseInt(y[1],10),parseInt(y[2],10),parseInt(y[3],10)];return[B,A]}};var u=function(){this.init.apply(this,arguments)};var j=function(){var v="transition",y=t("div"),x=["Webkit","Moz","O"];if(y.style[v]===undefined){for(var w=0;w<x.length;w++){if(y.style[v=x[w]+"Transition"]!==undefined){return v}}return null}return"transition"};u.DefaultOption={fps:25,duration:1000,onStart:r,onComplete:r,easing:"linear",css3support:true};u.prototype=(function(){var v={};return{init:function(y,x,w){this.el=e(y);this.props=x||{};this.from={};this.to={};this.unit={};w=w||{};Cold.extend(u.DefaultOption,w,true);Cold.extend(this,u.DefaultOption,true);if(this.css3support){if(/linear|easeIn|easeOut|easeInOut|cubic-bezier\(.*\)/.test(this.easing)){this.transitionName=j()}if(this.transitionName==="MozTransition"){for(var z in this.props){if(/top|left|right|bottom/i.test(z)&&!this.el.style[z]){n(this.el,z,n(this.el,z))}}}if(this.transitionName){this.el.css3AnimNum||this.el.css3AnimNum===1?this.el.css3AnimNum++:(this.el.css3AnimNum=1)}}},initData:function(){this.begin=k();this.end=this.begin+this.duration;for(var x in this.props){var z=this.props[x],w=Cold.isString(z)?z.match(/^(\d*)(\.\d*)?(.*)$/):z;if(g.isColorStyle(x)){var y=g.init(this.el,x,z);this.from[x]=y[0];this.to[x]=y[1]}else{if(w!=null){this.from[x]=parseFloat(this.el[x]||n(this.el,x));this.to[x]=w[1]||w;this.unit[x]=w[3]||"px"}else{throw"anim init: Invalid arguments."}}}},step:function(){var w=k();if(w<this.end){this.update((w-this.begin)/this.duration)}else{this.stop&&this.stop();this.update(1);this.onComplete&&this.onComplete()}},update:function(w){for(var x in this.props){var y=this.compute(this.from[x],this.to[x],w);if(s(this.el,x)){if(x!=="opacity"&&!g.isColorStyle(x)){y=parseInt(y,10)+this.unit[x]}n(this.el,x,y)}else{this.el[x]=y}}},compute:function(C,B,x){var A=d[this.easing||"linear"];if(Cold.isArray(C)){var z=parseInt(C[0]+(B[0]-C[0])*A(x),10),w=parseInt(C[1]+(B[1]-C[1])*A(x),10),y=parseInt(C[2]+(B[2]-C[2])*A(x),10);return"rgb("+z+","+w+","+y+")"}return C+(B-C)*A(x)},pause:function(){this.paused=true},resume:function(){this.paused=false},reset:function(){this.update(0);this.stop()},start:function(x){!this.transitionName&&this.stop();var y=false,w;x=x||false;var z=function(A){return String(A).replace(/[A-Z]/g,"-$&").toLowerCase()};var w=(function(A){return function(){A.initData();var B=A.onComplete,C;A.onStart&&A.onStart();A.onComplete=function(){B&&B();if(y||x){C=v[A.el].shift();C?C():delete v[A.el]}};if(A.transitionName){var D="all "+A.duration+"ms "+z(A.easing);A.el.style[A.transitionName]=D;setTimeout(function(){A.el.style[A.transitionName]=D;A.update(1)},0);setTimeout(function(){A.stop();A.onComplete&&A.onComplete()},A.duration)}else{A.timer=setInterval(function(){if(A.paused){A.end+=A.fps;return}A.step.call(A)},A.fps||u.DefaultOption.fps)}}})(this);if(!(this.el in v)){y=true;v[this.el]=[];w();return}x?v[this.el].push(w):w()},stop:function(){if(this.transitionName){if(Cold.isNumber(this.el.css3AnimNum)&&--this.el.css3AnimNum===0){n(this.el,this.transitionName,"")}}else{this.timer&&clearInterval(this.timer);this.timer=null}}}})();var i=function(v){v=v||false;return function(y,x,C,A,B){var w={};if(Cold.isFunction(C)||C===null){w.onComplete=C;w.duration=A;w.easing=B}else{w=C}var z=new u(y,x,w);z.start(v);return this}};var l=i();var p=i(true);var o=function(v,w,A,y,z){if(n(v,"position")!=="static"){var x=new u(v,{left:w[0],top:w[1]},{duration:y,onComplete:A,easing:z});x.start()}else{throw"position is static, cant move!"}};var q=function(v,A,z,x,y){var w=new u(v,{opacity:A},{duration:x,onComplete:z,easing:y});w.start()};var m=function(v,z,x,y){var w=new u(v,{opacity:1},{duration:x,onComplete:z,easing:y});w.start()};var b=function(v,z,x,y){var w=new u(v,{opacity:0},{duration:x,onComplete:z,easing:y});w.start()};var a=function(v,A,z,x,y){var w=new u(v,{height:A},{duration:x,onComplete:z,easing:y});w.start()};var c=function(A,C,z,B){var w=A.match(/\s*#(.*)\s*/);if(w){A=h(e(w[1]))["y"]}var y=document,v=y.documentElement;var x=new u((v.scrollTop?v:y.body),{scrollTop:A},{duration:Cold.isFunction(C)?z:C,onComplete:Cold.isFunction(C)?C:r,easing:B});x.start()};return{run:l,queue:p,move:o,fade:q,fadeIn:m,fadeOut:b,slide:a,scrollTo:c,Easing:d}});