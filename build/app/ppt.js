Cold.add("app.ppt",["dom","anim","event"],function(){var d=Cold.dom,c=Cold.anim,b=Cold.event;var a={goTo:function(e){a.curr=e;window.location.hash="#slide-"+e;c.run(a.slides,{"margin-top":-(e-1)*a.height+"px"},function(){},600,"easeOutStrong");a.showInfo()},prev:function(){(a.curr>1)?a.goTo(--a.curr):a.goTo(1)},next:function(){(a.curr<a.length)?a.goTo(++a.curr):a.goTo(a.length)},domBind:function(){b.click(d.id("prev"),function(){a.prev()});b.click(d.id("next"),function(){a.next()})},resize:function(){d.css(document.body,{width:screen.width+"px",height:screen.height+"px"});d.css(a.win,{height:screen.height+"px"});d.css(a.pages,{height:screen.height-120+"px"})},keyBind:function(){b.add(document,"keyup",function(f){switch(f.keyCode){case 33:case 37:case 38:a.prev();break;case 32:case 34:case 39:case 40:a.next();break;case 36:a.goTo(1);break;case 35:a.goTo(a.length);break}return false})},showInfo:function(){if(!d.id("pptPageInfo")){var g=d.create("div");g.id="pptTime";g.innerHTML="- 00:00 -";g.className="info";d.css(g,{right:"55px","text-align":"right"});var f=d.create("div");f.id="pptPageInfo";f.innerHTML=a.curr+"/"+a.length;f.className="info";d.css(f,{left:"55px"});d.css(a.win,"position","relative");d.appendEnd(a.win,g);d.appendEnd(a.win,f);var e=0;setInterval(function(){e++;var h=parseInt(e/60);var i=e%60;h=h>=10?h:"0"+h;i=i>=10?i:"0"+i;g.innerHTML="- "+h+":"+i+" -"},1000)}else{d.id("pptPageInfo").innerHTML=a.curr+"/"+a.length}},init:function(){a.pages=d.$CN("slide");a.win=d.id("presentation");a.slides=a.pages[0].parentNode;a.length=a.pages.length;a.height=window.screen.height;a.curr=window.location.hash.replace("#slide-","")||1;a.goTo(a.curr);a.domBind();a.keyBind();a.showInfo();a.resize()}};a.init()});