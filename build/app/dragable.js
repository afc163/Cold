Cold.add("app.dragable",["dom","event"],function(){var a=Cold.event,f=Cold.dom;var n,l,o,i,m=f.create("div"),p="module";m.id="dashedBox";m.className=p;f.css(m,"border","2px dashed #C5E9E2");var c=f.id("presentation");var k=f.$CN(p),r=k[0].parentNode.parentNode;var e=function(s,h){this.name=h;this.node=s;this.x=f.getXY(this.node)["x"];this.init()};e.prototype={init:function(){this.items=f.$CN(this.name,this.node);this.lines=[];this.calLines()},calLines:function(){var h=this;Cold.each(this.items,function(t){var u=f.getXY(t)["y"];var s=f.height(t);h.lines.push(u+s*0.6)})},whichArea:function(t){var s=t.y,h=0;Cold.each(this.lines,function(u){if(s<u){return false}h++});return h}};var d=new e(f.$CN("area_1")[0],p);var b=new e(f.$CN("area_2")[0],p);Cold.each(k,function(t){var h=t.getElementsByTagName("div")[0];f.css(h,"cursor","move");var s=function(w){w=a.fix(w);t.style.left=w.clientX-n+"px";t.style.top=w.clientY-l+"px";var v={min:Number.MAX_VALUE,target:m,index:-1,dashedMoved:false,pos:{x:w.clientX-n,y:w.clientY-l}};var z=Math.abs(v.pos.x-d.x),y=Math.abs(v.pos.x-b.x),x=(y>z)?d:b;var u=x.whichArea(v.pos);if(u===x.items.length){f.appendEnd(x.node,m);v.dashedMoved=true}else{if(u-1>=0&&x.items[u-1]===m){f.insertAfter(x.items[u],m);v.dashedMoved=true}else{if(x.items[u]!==m){f.insertBefore(x.items[u],m);v.dashedMoved=true}}}if(v.dashedMoved){d.init();b.init()}};a.add(h,"mousedown",function(v){if(v.target!==h){return}q();j(t,false);var w=f.getXY(t);if(c){var u=f.getXY(c);w.x-=u.x;w.y-=u.y}n=v.clientX-w.x;l=v.clientY-w.y;o=f.width(t);i=f.height(t);f.css(t,{position:"absolute",width:o-2+"px",height:i-2+"px",opacity:0.7});t.className="moveable";f.css(m,{width:o-4+"px",height:i-4+"px","margin-bottom":"20px",display:"block"});f.insertAfter(t,m);m.className=p;document.onmousemove=s;document.onmouseup=function(){document.onmousemove=null;f.insertAfter(m,t);f.css(t,{position:"static",left:"",top:"",opacity:""});t.className=p;f.css(m,"display","none");m.className="";j(t,true);g()}})});function j(t,h){var s=function(){return false};if(typeof t.onselectstart!="undefined"){t.onselectstart=(h?null:s)}else{if(typeof t.style.MozUserSelect!="undefined"){t.style.MozUserSelect=(h?null:"none")}else{t.onmousedown=(h?null:s)}}}function q(){var h=f.id("maskdiv");if(!h){h=f.create("div",{id:"maskdiv"});f.css(h,{width:"100%",position:"absolute",top:"0",left:"0",background:"url(http://www.google.com/c.gif)","z-index":"9999"})}f.css(h,{height:Cold.browser.pageSize()["height"]+"px"});f.appendEnd(document.body,h)}function g(){f.remove(f.id("maskdiv"))}});